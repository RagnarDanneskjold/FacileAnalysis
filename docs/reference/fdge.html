<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Peform a differential expression analysis. — compare.FacileTtestAnalysisResult • FacileAnalysis</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Peform a differential expression analysis. — compare.FacileTtestAnalysisResult" />

<meta property="og:description" content="Use fdge_model_def() to define the design matrix and contrast to test and
pass the FacileDgeModelDefinition object returned from that to fdge()
to run the desired differential testing framework (dictated by the method
parameter) over the data. fdge_model_def accepts a" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FacileAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FacileAnalysis.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FacileAnalysis-fdge.html">Facile Differential Expression Analysis</a>
    </li>
    <li>
      <a href="../articles/FacileAnalysis-fpca.html">Facile Principal Components Analysis</a>
    </li>
    <li>
      <a href="../articles/FacileAnalysis-fsea.html">Facile (Gene) Set Expression Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peform a differential expression analysis.</h1>
    
    <div class="hidden name"><code>fdge.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Use <code><a href='fdge_model_def.html'>fdge_model_def()</a></code> to define the design matrix and contrast to test and
pass the <code>FacileDgeModelDefinition</code> object returned from that to <code>fdge()</code>
to run the desired differential testing framework (dictated by the <code>method</code>
parameter) over the data. <code>fdge_model_def</code> accepts a</p>
    
    </div>

    <pre class="usage"><span class='co'># S3 method for FacileTtestAnalysisResult</span>
<span class='fu'><a href='compare.html'>compare</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FacileTtestAnalysisResult</span>
<span class='fu'><a href='FacileAnalysisResultViz.html'>report</a></span>(<span class='no'>x</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"dge"</span>,
  <span class='st'>"features"</span>), <span class='kw'>ntop</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>max_padj</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>min_logFC</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>features</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>round_digits</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>event_source</span> <span class='kw'>=</span> <span class='st'>"A"</span>,
  <span class='kw'>webgl</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>caption</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>fdge</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for FacileAnovaModelDefinition</span>
<span class='fu'>fdge</span>(<span class='no'>x</span>, <span class='kw'>assay_name</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filter</span> <span class='kw'>=</span> <span class='st'>"default"</span>, <span class='kw'>with_sample_weights</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>)

<span class='co'># S3 method for FacileDgeModelDefinition</span>
<span class='fu'>fdge</span>(<span class='no'>x</span>, <span class='kw'>assay_name</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filter</span> <span class='kw'>=</span> <span class='st'>"default"</span>, <span class='kw'>with_sample_weights</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>treat_lfc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data source</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>passed down into inner methods, such as <code>biocbox</code> to tweak
filtering criteria, for instance</p></td>
    </tr>
    <tr>
      <th>assay_name</th>
      <td><p>the name of the assay that holds the measurements for test.
Defaults to <code>default_assay(x)</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The differential testing framework to use over the data. The
valid choices are defined by the type of assay <code>assay_name</code>is. Refer to the
<em>Differential Expression Testing Methods</em> section for more details.</p></td>
    </tr>
    <tr>
      <th>filter, with_sample_weights</th>
      <td><p>Passed into <code><a href='biocbox.html'>biocbox()</a></code> to determine which
features (genes) are removed from the dataset for testing, as well as if
to use <code><a href='https://www.rdocumentation.org/packages/limma/topics/arrayWeights'>limma::arrayWeights()</a></code> or <code><a href='https://www.rdocumentation.org/packages/limma/topics/voomWithQualityWeights'>limma::voomWithQualityWeights()</a></code>
(where appropriate) when testing (default is not to).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="comapring-dge-results"><a class="anchor" href="#comapring-dge-results"></a>Comapring DGE Results</h2>

    
    <p>We can compare two Ttest results</p>
    
    <h2 class="hasAnchor" id="interacting-with-results"><a class="anchor" href="#interacting-with-results"></a>Interacting with results</h2>

    
    <p>The <code>report</code> function will create an htmlwidget which can be explored by
the analyst or dropped into an Rmarkdown report.</p>
<p><code><a href='FacileAnalysisResultViz.html'>report(result, "dge", max_padj = 0.05, min_logFC = 1)</a></code> will create a
side-by-side volcano and datatable for differential expression results.</p>
    
    <h2 class="hasAnchor" id="differential-expression-testing-methods"><a class="anchor" href="#differential-expression-testing-methods"></a>Differential Expression Testing Methods</h2>

    
    <p>The appropriate statistical framework to use for differential expression
testing is defined by the type of data that is recorded in the assay
<code>assay_name</code>, ie. <code>assay_info(x, assay_name)$assay_type</code>.</p>
<p>The <code><a href='fdge_methods.html'>fdge_methods()</a></code> function returns a tibble of appropriate
<code>assay_type -&gt; dge_method</code> associations. The first entry for each
<code>dge_method</code> is the default <code>method</code> used if one isn't provided by the
caller.</p>
<p>The available methods are:</p><ul>
<li><p><code>"voom"</code>: For count data, uses <code><a href='https://www.rdocumentation.org/packages/limma/topics/voomWithQualityWeights'>limma::voomWithQualityWeights()</a></code> when
<code>with_sample_weights = TRUE</code>.</p></li>
<li><p><code>"edgeR-qlf"</code>: The edgeR quasi-likelihood method, for count data.</p></li>
<li><p><code>"limma-trend"</code>: Usable for log-transformed data that "looks like" it came
from count data, or where there is a "trend" of the variance with the
mean, uses  <code>lima::arrayWeights()</code> when <code>with_sample_weights = TRUE</code>.</p></li>
<li><p><code>"limma"</code>: Straightup limma, this expects log2-normal like data, with
(largely) no trend of the variance to the mean worth modeling. Uses
<code>lima::arrayWeights()</code> when <code>with_sample_weights = TRUE</code></p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Comparing two T-test results ----------------------------------------------</span>
<span class='co'># Let's compare the tumor vs normal DGE results in CRC vs BLCA</span>

<span class='no'>efds</span> <span class='kw'>&lt;-</span> <span class='fu'>exampleFacileDataSet</span>()</div><div class='output co'>#&gt; <span class='error'>Error in exampleFacileDataSet(): could not find function "exampleFacileDataSet"</span></div><div class='input'><span class='no'>dge.crc</span> <span class='kw'>&lt;-</span> <span class='fu'>filter_samples</span>(<span class='no'>efds</span>, <span class='no'>indication</span> <span class='kw'>==</span> <span class='st'>"CRC"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='fdge_model_def.html'>fdge_model_def</a></span>(<span class='st'>"sample_type"</span>, <span class='st'>"tumor"</span>, <span class='st'>"normal"</span>, <span class='st'>"sex"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>fdge</span>()</div><div class='output co'>#&gt; <span class='error'>Error in filter_samples(efds, indication == "CRC"): could not find function "filter_samples"</span></div><div class='input'><span class='no'>dge.blca</span> <span class='kw'>&lt;-</span> <span class='fu'>filter_samples</span>(<span class='no'>efds</span>, <span class='no'>indication</span> <span class='kw'>==</span> <span class='st'>"BLCA"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='fdge_model_def.html'>fdge_model_def</a></span>(<span class='st'>"sample_type"</span>, <span class='st'>"tumor"</span>, <span class='st'>"normal"</span>, <span class='st'>"sex"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>fdge</span>()</div><div class='output co'>#&gt; <span class='error'>Error in filter_samples(efds, indication == "BLCA"): could not find function "filter_samples"</span></div><div class='input'><span class='no'>dge.comp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='compare.html'>compare</a></span>(<span class='no'>dge.crc</span>, <span class='no'>dge.blca</span>)</div><div class='output co'>#&gt; <span class='error'>Error in compare(dge.crc, dge.blca): object 'dge.crc' not found</span></div><div class='input'><span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/interactive'>interactive</a></span>()) {
  <span class='fu'><a href='FacileAnalysisResultViz.html'>report</a></span>(<span class='no'>dge.comp</span>)
  <span class='fu'><a href='FacileAnalysisResultViz.html'>shine</a></span>(<span class='no'>dge.comp</span>)
}
<span class='no'>efds</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>FacileData</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/FacileData/topics/exampleFacileDataSet'>exampleFacileDataSet</a></span>()
<span class='no'>samples</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>FacileData</span><span class='kw ns'>::</span><span class='fu'>filter_samples</span>(<span class='no'>efds</span>, <span class='no'>indication</span> <span class='kw'>==</span> <span class='st'>"BLCA"</span>)
<span class='no'>mdef</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fdge_model_def.html'>fdge_model_def</a></span>(<span class='no'>samples</span>, <span class='kw'>covariate</span> <span class='kw'>=</span> <span class='st'>"sample_type"</span>,
                       <span class='kw'>numer</span> <span class='kw'>=</span> <span class='st'>"tumor"</span>, <span class='kw'>denom</span> <span class='kw'>=</span> <span class='st'>"normal"</span>, <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='st'>"sex"</span>)
<span class='no'>dge</span> <span class='kw'>&lt;-</span> <span class='fu'>fdge</span>(<span class='no'>mdef</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"voom"</span>)
<span class='no'>dge.sig</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='signature.html'>signature</a></span>(<span class='no'>dge</span>)</div><div class='output co'>#&gt; <span class='error'>Error in UseMethod("signature", x): no applicable method for 'signature' applied to an object of class "c('Facile%sFeatureRanks%s', 'FacileFeatureRanks', 'FacileAnalysisResult')"</span></div><div class='input'><span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/interactive'>interactive</a></span>()) {
  <span class='fu'><a href='FacileAnalysisResultViz.html'>viz</a></span>(<span class='no'>dge</span>)
  <span class='fu'><a href='FacileAnalysisResultViz.html'>shine</a></span>(<span class='no'>dge</span>)
}

<span class='no'>stage.anova</span> <span class='kw'>&lt;-</span> <span class='no'>samples</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='fdge_model_def.html'>fdge_model_def</a></span>(<span class='kw'>covariate</span> <span class='kw'>=</span> <span class='st'>"stage"</span>, <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='st'>"sex"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>fdge</span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"voom"</span>)
<span class='no'>anova.sig</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='signature.html'>signature</a></span>(<span class='no'>stage.anova</span>)</div><div class='output co'>#&gt; <span class='error'>Error in UseMethod("signature", x): no applicable method for 'signature' applied to an object of class "c('Facile%sFeatureRanks%s', 'FacileFeatureRanks', 'FacileAnalysisResult')"</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#comapring-dge-results">Comapring DGE Results</a></li>

      <li><a href="#interacting-with-results">Interacting with results</a></li>

      <li><a href="#differential-expression-testing-methods">Differential Expression Testing Methods</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

